query courseRegistrationsForActivity($activityId: String!){
  courseRegistrationsCollection(
    filter: {activityId: {eq: $activityId}},
    orderBy: { createdAt: DescNullsLast }
  ){
    totalCount
    edges{
      node{
        id
        name
        satrDate
        satrPlace
        recommendation
        paymentReceiptUrl
        photoUrl
      }
    }
  }
}

query loadAllCourses($gender: GenderFilter){
  activitiesCollection(
    filter: {
      type: {eq: COURSE},
      or: [
        { allowedGender: {eq: $gender} }
        { allowedGender: {eq: ANY} }
      ]
    },
    orderBy: { startDatetime: DescNullsLast }
  ) {
    edges {
      node {
        id
        name
        shortDescription
        startDatetime
        endDatetime
        allowedGender
        address {
          district
          state
          latitude
          longitude
        }
        capacity
        courseRegistrationsCollection {
          pageInfo {
            startCursor
          }
          edges {
            node {
              id
            }
          }
        }
      }
    }
  }
}

mutation registerForCourse($input: CourseRegistrationsInsertInput!){
  insertIntoCourseRegistrationsCollection(objects: [$input]){
    affectedCount
  }
}

query allUpcomingCourses($currentDateTime: Datetime!, $gender: GenderFilter) {
  activitiesCollection(
    filter: {
      startDatetime: {gt: $currentDateTime},
      type: {eq: COURSE},
      or: [
        { allowedGender: {eq: $gender} }
        { allowedGender: {eq: ANY} }
      ]
    }
  ) {
    edges {
      node {
        id
        name
        shortDescription
        startDatetime
        endDatetime
        allowedGender
        address {
          district
          state
          latitude
          longitude
        }
        capacity
        courseRegistrationsCollection {
          pageInfo {
            startCursor
          }
          edges {
            node {
              id
            }
          }
        }
      }
    }
  }
}
